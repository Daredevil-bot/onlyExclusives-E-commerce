(self.webpackChunkecommerce_app=self.webpackChunkecommerce_app||[]).push([[386],{3386:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>C});var r=n(5043),o="https://js.stripe.com/v3",a=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,c="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",s=null,i=function(e){return null!==s||(s=new Promise(function(t,n){if("undefined"!==typeof window&&"undefined"!==typeof document)if(window.Stripe&&e&&console.warn(c),window.Stripe)t(window.Stripe);else try{var r=function(){for(var e=document.querySelectorAll('script[src^="'.concat(o,'"]')),t=0;t<e.length;t++){var n=e[t];if(a.test(n.src))return n}return null}();r&&e?console.warn(c):r||(r=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(o).concat(t);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(n),n}(e)),r.addEventListener("load",function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))}),r.addEventListener("error",function(){n(new Error("Failed to load Stripe.js"))})}catch(s){return void n(s)}else t(null)})),s},u=Promise.resolve().then(function(){return i(null)}),l=!1;u.catch(function(e){l||console.warn(e)});var p=n(3393),f=n(9379),d=n(4556),m=n(854),y=n.n(m);var h=n(6507),v=n(6655),g=n(6401),E=n(3390),b=n(9335),S=n(579);const j=()=>{const e=(0,d.wA)(),{user:t}=(0,d.d4)(e=>(0,f.A)({},e)),[n,o]=(0,r.useState)(!1),[a,c]=(0,r.useState)(null),[s,i]=(0,r.useState)(!1),[u,l]=(0,r.useState)(!0),[m,j]=(0,r.useState)(""),[w,C]=(0,r.useState)(0),[x,k]=(0,r.useState)(0),A=(0,p.useStripe)(),O=(0,p.useElements)();(0,r.useEffect)(()=>{(async e=>(console.log("hey"),await y().post("http://localhost:8000/api/create-payment-intent",{},{headers:{authtoken:e}})))(t.token).then(e=>{console.log("hey"),console.log("create payment intent",e),j(e.data.clientSecret),C(e.data.cartTotal),k(e.data.cartTotal)})},[]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{className:"text-center pb-5",children:(0,S.jsx)(v.A,{cover:(0,S.jsx)("img",{src:b,style:{height:"200px",objectFit:"contain",marginBottom:"-50px"}}),actions:[(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(g.A,{className:"text-info"})," ",(0,S.jsx)("br",{}),"Cart Total: Rs.",w]}),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(E.A,{className:"text-info"})," ",(0,S.jsx)("br",{})," Total Payable : Rs.",x]})]})}),(0,S.jsxs)("form",{id:"payment-form",className:"stripe-form",onSubmit:async n=>{n.preventDefault(),i(!0);const r=await A.confirmCardPayment(m,{payment_method:{card:O.getElement(p.CardElement),billing_details:{name:n.target.name.value}}});r.error?(c("Payment failed ".concat(r.error.message)),i(!1)):((0,h.fS)(r,t.token).then(n=>{n.data.ok&&("undefined"!==typeof window&&localStorage.removeItem("cart"),e({type:"ADD_TO_CART",payload:[]}),(0,h.a_)(t.token))}),console.log(JSON.stringify(r,null,4)),c(null),i(!1),o(!0))},children:[(0,S.jsx)(p.CardElement,{id:"card-element",options:{style:{base:{color:"#32325d",fontFamily:"Arial, sans-serif",fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#32325d"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}}},onChange:async e=>{l(e.empty),c(e.error?e.error.message:"")}}),(0,S.jsx)("button",{className:"stripe-button",disabled:s||n||u,children:(0,S.jsx)("span",{id:"button-text",children:s?(0,S.jsx)("div",{className:"spinner",id:"spinner"}):"Pay"})}),a&&(0,S.jsx)("div",{className:"card-error",role:"alert",children:a})]})]})},w=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];l=!0;var r=Date.now();return u.then(function(e){return function(e,t,n){if(null===e)return null;var r=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"1.54.2",startTime:t})}(r,n),r}(e,t,r)})}("pk_test_51LGNsuSGibpL3rGjI6Qwjiaoahs28Ozu2YPNqULY92tIw7HIGDao1vOC63vXlWsBlcyUmRjQPjfEoS1Vmdg10D2P00oiJ6bCWW"),C=()=>(0,S.jsxs)("div",{className:"container p-5 text-center",children:[(0,S.jsx)("h4",{children:"Complete your Purchase"}),(0,S.jsx)(p.Elements,{stripe:w,children:(0,S.jsx)("div",{className:"col-md-8 offset-md-2",children:(0,S.jsx)("p",{children:(0,S.jsx)(j,{})})})})]})},3390:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(9379),o=n(5043);const a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"};var c=n(2172),s=function(e,t){return o.createElement(c.A,(0,r.A)((0,r.A)({},e),{},{ref:t,icon:a}))};const i=o.forwardRef(s)},3393:function(e,t,n){!function(e,t){"use strict";function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){a(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function o(e){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){return s(e)||i(e,t)||u(e,t)||p()}function s(e){if(Array.isArray(e))return e}function i(e,t){var n=e&&("undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r,o,a=[],c=!0,s=!1;try{for(n=n.call(e);!(c=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);c=!0);}catch(i){s=!0,o=i}finally{try{c||null==n.return||n.return()}finally{if(s)throw o}}return a}}function u(e,t){if(e){if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){return e(t={exports:{}},t.exports),t.exports}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var d="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";function m(){}function y(){}y.resetWarningCache=m;var h=function(){function e(e,t,n,r,o,a){if(a!==d){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:y,resetWarningCache:m};return n.PropTypes=n,n},v=f(function(e){e.exports=h()}),g=function(e){var n=t.useRef(e);return t.useEffect(function(){n.current=e},[e]),n.current},E=function(e){return null!==e&&"object"===o(e)},b=function(e){return E(e)&&"function"===typeof e.then},S=function(e){return E(e)&&"function"===typeof e.elements&&"function"===typeof e.createToken&&"function"===typeof e.createPaymentMethod&&"function"===typeof e.confirmCardPayment},j="[object Object]",w=function e(t,n){if(!E(t)||!E(n))return t===n;var r=Array.isArray(t);if(r!==Array.isArray(n))return!1;var o=Object.prototype.toString.call(t)===j;if(o!==(Object.prototype.toString.call(n)===j))return!1;if(!o&&!r)return t===n;var a=Object.keys(t),c=Object.keys(n);if(a.length!==c.length)return!1;for(var s={},i=0;i<a.length;i+=1)s[a[i]]=!0;for(var u=0;u<c.length;u+=1)s[c[u]]=!0;var l=Object.keys(s);if(l.length!==a.length)return!1;var p=t,f=n,d=function(t){return e(p[t],f[t])};return l.every(d)},C=function(e,t,n){return E(e)?Object.keys(e).reduce(function(o,c){var s=!E(t)||!w(e[c],t[c]);return n.includes(c)?(s&&console.warn("Unsupported prop change: options.".concat(c," is not a mutable property.")),o):s?r(r({},o||{}),{},a({},c,e[c])):o},null):null},x="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",k=function(e){if(null===e||S(e))return e;throw new Error(x)},A=function(e){if(b(e))return{tag:"async",stripePromise:Promise.resolve(e).then(k)};var t=k(e);return null===t?{tag:"empty"}:{tag:"sync",stripe:t}},O=t.createContext(null);O.displayName="ElementsContext";var P=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},_=t.createContext(null);_.displayName="CartElementContext";var N=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},R=function(e){var n=e.stripe,r=e.options,o=e.children,a=t.useMemo(function(){return A(n)},[n]),s=c(t.useState(null),2),i=s[0],u=s[1],l=c(t.useState(null),2),p=l[0],f=l[1],d=c(t.useState(function(){return{stripe:"sync"===a.tag?a.stripe:null,elements:"sync"===a.tag?a.stripe.elements(r):null}}),2),m=d[0],y=d[1];t.useEffect(function(){var e=!0,t=function(e){y(function(t){return t.stripe?t:{stripe:e,elements:e.elements(r)}})};return"async"!==a.tag||m.stripe?"sync"!==a.tag||m.stripe||t(a.stripe):a.stripePromise.then(function(n){n&&e&&t(n)}),function(){e=!1}},[a,m,r]);var h=g(n);t.useEffect(function(){null!==h&&h!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[h,n]);var v=g(r);return t.useEffect(function(){if(m.elements){var e=C(r,v,["clientSecret","fonts"]);e&&m.elements.update(e)}},[r,v,m.elements]),t.useEffect(function(){var e=m.stripe;e&&e._registerWrapper&&e.registerAppInfo&&(e._registerWrapper({name:"react-stripe-js",version:"1.16.5"}),e.registerAppInfo({name:"react-stripe-js",version:"1.16.5",url:"https://stripe.com/docs/stripe-js/react"}))},[m.stripe]),t.createElement(O.Provider,{value:m},t.createElement(_.Provider,{value:{cart:i,setCart:u,cartState:p,setCartState:f}},o))};R.propTypes={stripe:v.any,options:v.object};var T=function(e){var n=t.useContext(O);return P(n,e)},B=function(e){var n=t.useContext(_);return N(n,e)},I=function(){return T("calls useElements()").elements},L=function(){return T("calls useStripe()").stripe},M=function(){return B("calls useCartElement()").cart},F=function(){return B("calls useCartElementState()").cartState},D=function(e){return(0,e.children)(T("mounts <ElementsConsumer>"))};D.propTypes={children:v.func.isRequired};var W=function(e,n,r){var o=!!r,a=t.useRef(r);t.useEffect(function(){a.current=r},[r]),t.useEffect(function(){if(!o||!e)return function(){};var t=function(){a.current&&a.current.apply(a,arguments)};return e.on(n,t),function(){e.off(n,t)}},[o,n,e,a])},U=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},q=function(e,n){var r="".concat(U(e),"Element"),o=n?function(e){T("mounts <".concat(r,">")),B("mounts <".concat(r,">"));var n=e.id,o=e.className;return t.createElement("div",{id:n,className:o})}:function(n){var o,a=n.id,s=n.className,i=n.options,u=void 0===i?{}:i,l=n.onBlur,p=n.onFocus,f=n.onReady,d=n.onChange,m=n.onEscape,y=n.onClick,h=n.onLoadError,v=n.onLoaderStart,E=n.onNetworksChange,b=n.onCheckout,S=n.onLineItemClick,j=n.onConfirm,w=n.onCancel,x=n.onShippingAddressChange,k=n.onShippingRateChange,A=T("mounts <".concat(r,">")).elements,O=c(t.useState(null),2),P=O[0],_=O[1],N=t.useRef(null),R=t.useRef(null),I=B("mounts <".concat(r,">")),L=I.setCart,M=I.setCartState;W(P,"blur",l),W(P,"focus",p),W(P,"escape",m),W(P,"click",y),W(P,"loaderror",h),W(P,"loaderstart",v),W(P,"networkschange",E),W(P,"lineitemclick",S),W(P,"confirm",j),W(P,"cancel",w),W(P,"shippingaddresschange",x),W(P,"shippingratechange",k),"cart"===e?o=function(e){M(e),f&&f(e)}:f&&(o="payButton"===e?f:function(){f(P)}),W(P,"ready",o),W(P,"change","cart"===e?function(e){M(e),d&&d(e)}:d),W(P,"checkout","cart"===e?function(e){M(e),b&&b(e)}:b),t.useLayoutEffect(function(){if(null===N.current&&A&&null!==R.current){var t=A.create(e,u);"cart"===e&&L&&L(t),N.current=t,_(t),t.mount(R.current)}},[A,u,L]);var F=g(u);return t.useEffect(function(){if(N.current){var e=C(u,F,["paymentRequest"]);e&&N.current.update(e)}},[u,F]),t.useLayoutEffect(function(){return function(){N.current&&(N.current.destroy(),N.current=null)}},[]),t.createElement("div",{id:a,className:s,ref:R})};return o.propTypes={id:v.string,className:v.string,onChange:v.func,onBlur:v.func,onFocus:v.func,onReady:v.func,onEscape:v.func,onClick:v.func,onLoadError:v.func,onLoaderStart:v.func,onNetworksChange:v.func,onCheckout:v.func,onLineItemClick:v.func,onConfirm:v.func,onCancel:v.func,onShippingAddressChange:v.func,onShippingRateChange:v.func,options:v.object},o.displayName=r,o.__elementType=e,o},z="undefined"===typeof window,V=q("auBankAccount",z),Y=q("card",z),G=q("cardNumber",z),H=q("cardExpiry",z),J=q("cardCvc",z),K=q("fpxBank",z),Q=q("iban",z),$=q("idealBank",z),X=q("p24Bank",z),Z=q("epsBank",z),ee=q("payment",z),te=q("payButton",z),ne=q("paymentRequestButton",z),re=q("linkAuthentication",z),oe=q("address",z),ae=q("shippingAddress",z),ce=q("cart",z),se=q("paymentMethodMessaging",z),ie=q("affirmMessage",z),ue=q("afterpayClearpayMessage",z);e.AddressElement=oe,e.AffirmMessageElement=ie,e.AfterpayClearpayMessageElement=ue,e.AuBankAccountElement=V,e.CardCvcElement=J,e.CardElement=Y,e.CardExpiryElement=H,e.CardNumberElement=G,e.CartElement=ce,e.Elements=R,e.ElementsConsumer=D,e.EpsBankElement=Z,e.FpxBankElement=K,e.IbanElement=Q,e.IdealBankElement=$,e.LinkAuthenticationElement=re,e.P24BankElement=X,e.PayButtonElement=te,e.PaymentElement=ee,e.PaymentMethodMessagingElement=se,e.PaymentRequestButtonElement=ne,e.ShippingAddressElement=ae,e.useCartElement=M,e.useCartElementState=F,e.useElements=I,e.useStripe=L,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(5043))},6401:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(9379),o=n(5043);const a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm47.7-395.2l-25.4-5.9V348.6c38 5.2 61.5 29 65.5 58.2.5 4 3.9 6.9 7.9 6.9h44.9c4.7 0 8.4-4.1 8-8.8-6.1-62.3-57.4-102.3-125.9-109.2V263c0-4.4-3.6-8-8-8h-28.1c-4.4 0-8 3.6-8 8v33c-70.8 6.9-126.2 46-126.2 119 0 67.6 49.8 100.2 102.1 112.7l24.7 6.3v142.7c-44.2-5.9-69-29.5-74.1-61.3-.6-3.8-4-6.6-7.9-6.6H363c-4.7 0-8.4 4-8 8.7 4.5 55 46.2 105.6 135.2 112.1V761c0 4.4 3.6 8 8 8h28.4c4.4 0 8-3.6 8-8.1l-.2-31.7c78.3-6.9 134.3-48.8 134.3-124-.1-69.4-44.2-100.4-109-116.4zm-68.6-16.2c-5.6-1.6-10.3-3.1-15-5-33.8-12.2-49.5-31.9-49.5-57.3 0-36.3 27.5-57 64.5-61.7v124zM534.3 677V543.3c3.1.9 5.9 1.6 8.8 2.2 47.3 14.4 63.2 34.4 63.2 65.1 0 39.1-29.4 62.6-72 66.4z"}}]},name:"dollar",theme:"outlined"};var c=n(2172),s=function(e,t){return o.createElement(c.A,(0,r.A)((0,r.A)({},e),{},{ref:t,icon:a}))};const i=o.forwardRef(s)},6507:(e,t,n)=>{"use strict";n.d(t,{Ex:()=>i,FK:()=>l,KE:()=>a,UW:()=>c,a_:()=>s,fS:()=>u});var r=n(854),o=n.n(r);const a=async(e,t)=>o().post("http://localhost:8000/api/user/cart",{cart:e},{headers:{authtoken:t}}),c=async e=>o().get("http://localhost:8000/api/user/cart",{headers:{authtoken:e}}),s=async e=>o().delete("http://localhost:8000/api/user/cart",{headers:{authtoken:e}}),i=async(e,t)=>o().post("http://localhost:8000/api/user/address",{address:t},{headers:{authtoken:e}}),u=async(e,t)=>o().post("http://localhost:8000/api/user/order",{stripeResponse:e},{headers:{authtoken:t}}),l=async e=>await o().get("http://localhost:8000/api/user/orders",{headers:{authtoken:e}})},9335:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/laptop.00efca79d04f6275b91d.png"}}]);
//# sourceMappingURL=386.0592053e.chunk.js.map